<!DOCTYPE html>
<html>
<head>
  <title>Google Form to Website Content</title>
</head>
<body>

  <h1>Website Content Generator</h1>

  <iframe src="https://docs.google.com/forms/d/e/YOUR_FORM_ID/viewform?embedded=true" width="640" height="480" frameborder="0" marginheight="0" marginwidth="0">Loadingâ€¦</iframe>

  <div id="websiteContent">
    </div>

  <script>
    // Replace 'YOUR_FORM_ID' with the actual ID of your Google Form.
    // Replace 'YOUR_SHEET_ID' with the actual ID of the Google Sheet connected to your Google Form.
    const formId = 'YOUR_FORM_ID';
    const sheetId = 'YOUR_SHEET_ID';

    function fetchAndDisplayContent() {
      const sheetUrl = `https://docs.google.com/spreadsheets/d/e/${sheetId}/pub?output=csv`;

      fetch(sheetUrl)
        .then(response => response.text())
        .then(csvData => {
          const rows = csvData.split('\n');
          const headers = rows[0].split(',');
          const data = rows.slice(1).map(row => {
            const values = row.split(',');
            const obj = {};
            headers.forEach((header, index) => {
              obj[header] = values[index];
            });
            return obj;
          });

          // Process the data and generate website content.
          const contentDiv = document.getElementById('websiteContent');
          contentDiv.innerHTML = ''; // Clear previous content

          if (data.length > 0 && Object.keys(data[0]).length > 1) { //check if the sheet actually contains data other than the headers.
            data.forEach(item => {
              // Example: Create a paragraph for each entry. Customize this based on your form fields.
              if(item[headers[0]]){ //check if the first column has data, if not skip the row.
                let content = '<p>';
                headers.forEach(header => {
                  if (item[header]) {
                    content += `<strong>${header}:</strong> ${item[header]}<br>`;
                  }
                });
                content += '</p>';
                contentDiv.innerHTML += content;
              }

            });
          } else {
            contentDiv.innerHTML = '<p>No data available yet. Please submit the form.</p>';
          }

        })
        .catch(error => {
          console.error('Error fetching data:', error);
          document.getElementById('websiteContent').innerHTML = '<p>Error loading data.</p>';
        });
    }

    // Fetch and display content initially and then every few seconds.
    fetchAndDisplayContent();
    setInterval(fetchAndDisplayContent, 5000); // Refresh every 5 seconds.
  </script>

</body>
</html>
